// Create additional Ignition modules for second engine module
@PART:HAS[@MODULE[MultiModeEngine],@MODULE[ModuleEngines*]:HAS[#chemTechEngineType[hydrogen]],@MODULE[ModuleEngines*]:HAS[#chemTechEngineType[bipropellantHydrolox]]]:BEFORE[zzz_ChemicalPropulsion]
{
	chemTechMultiModeEngineSupported = true
	@MODULE[ModuleIgnitionPropellant]:HAS[#moduleID[chemTechPropellant]]
	{
		@engineID = #$../MODULE[ModuleEngines*]:HAS[#chemTechEngineType[hydrogen]]/engineID$
	}
	+MODULE[ModuleIgnitionPropellant]:HAS[#moduleID[chemTechPropellant]]
	{
		@moduleID = chemTechPropellant2
		@engineID = #$../MODULE[ModuleEngines*]:HAS[#chemTechEngineType[bipropellantHydrolox]]/engineID$
	}
}
@PART:HAS[@MODULE[MultiModeEngine],@MODULE[ModuleEngines*]:HAS[#chemTechEngineType[jetKerosene]],@MODULE[ModuleEngines*]:HAS[#chemTechEngineType[bipropellantKerolox]]]:BEFORE[zzz_ChemicalPropulsion]
{
	chemTechMultiModeEngineSupported = true
	@MODULE[ModuleIgnitionPropellant]:HAS[#moduleID[chemTechFuel]]
	{
		@engineID = #$../MODULE[ModuleEngines*]:HAS[#chemTechEngineType[jetKerosene]]/engineID$
	}
	+MODULE[ModuleIgnitionPropellant]:HAS[#moduleID[chemTechFuel]]
	{
		@moduleID = chemTechFuel2
		@engineID = #$../MODULE[ModuleEngines*]:HAS[#chemTechEngineType[bipropellantKerolox]]/engineID$
		-ratio = _
	}
}
@PART:HAS[@MODULE[MultiModeEngine],@MODULE[ModuleEngines*]:HAS[#chemTechEngineType[jetHydrogen]],@MODULE[ModuleEngines*]:HAS[#chemTechEngineType[bipropellantHydrolox]]]:BEFORE[zzz_ChemicalPropulsion]
{
	chemTechMultiModeEngineSupported = true
	@MODULE[ModuleIgnitionPropellant]:HAS[#moduleID[chemTechFuel]]
	{
		@engineID = #$../MODULE[ModuleEngines*]:HAS[#chemTechEngineType[jetHydrogen]]/engineID$
	}
	+MODULE[ModuleIgnitionPropellant]:HAS[#moduleID[chemTechFuel]]
	{
		@moduleID = chemTechFuel2
		@engineID = #$../MODULE[ModuleEngines*]:HAS[#chemTechEngineType[bipropellantHydrolox]]/engineID$
		-ratio = _
	}
}
@PART:HAS[@MODULE[MultiModeEngine],@MODULE[ModuleEngines*]:HAS[#chemTechEngineType[jetKerosene]],!MODULE[ModuleEngines*]:HAS[~chemTechEngineType[jetKerosene]]]:BEFORE[zzz_ChemicalPropulsion]
{
	chemTechMultiModeEngineSupported = true
	+MODULE[ModuleIgnitionPropellant]:HAS[#moduleID[chemTechFuel]]
	{
		@moduleID = chemTechFuel2
		@engineID = #$../MODULE[ModuleEngines*],1/engineID$
		@ratio = #$../MODULE[ModuleEngines*]:HAS[@PROPELLANT[Kerosene],@PROPELLANT[IntakeAir]],1/PROPELLANT[Kerosene]/ratio$
	}
	+MODULE[ModuleIgnitionPropellant]:HAS[#moduleID[chemTechIntakeAir]]
	{
		@moduleID = chemTechIntakeAir2
		@engineID = #$../MODULE[ModuleEngines*],1/engineID$
		@ratio = #$../MODULE[ModuleEngines*]:HAS[@PROPELLANT[Kerosene],@PROPELLANT[IntakeAir]],1/PROPELLANT[IntakeAir]/ratio$
	}
}
@PART:HAS[@MODULE[MultiModeEngine],@MODULE[ModuleEngines*]:HAS[#chemTechEngineType[jetHydrogen]],!MODULE[ModuleEngines*]:HAS[~chemTechEngineType[jetHydrogen]]]:BEFORE[zzz_ChemicalPropulsion]
{
	chemTechMultiModeEngineSupported = true
	+MODULE[ModuleIgnitionPropellant]:HAS[#moduleID[chemTechFuel]]
	{
		@moduleID = chemTechFuel2
		@engineID = #$../MODULE[ModuleEngines*],1/engineID$
		@ratio = #$../MODULE[ModuleEngines*]:HAS[@PROPELLANT[LqdHydrogen],@PROPELLANT[IntakeAir]],1/PROPELLANT[Kerosene]/ratio$
	}
	+MODULE[ModuleIgnitionPropellant]:HAS[#moduleID[chemTechIntakeAir]]
	{
		@moduleID = chemTechIntakeAir2
		@engineID = #$../MODULE[ModuleEngines*],1/engineID$
		@ratio = #$../MODULE[ModuleEngines*]:HAS[@PROPELLANT[LqdHydrogen],@PROPELLANT[IntakeAir]],1/PROPELLANT[IntakeAir]/ratio$
	}
}

// Don't need an additional Ignition for an electric fan, since there is no fuel
// so just mark these as supported so the fuelled engine will get a Ignition switch
@PART:HAS[@MODULE[MultiModeEngine],@MODULE[ModuleEngines*]:HAS[#chemTechEngineType[jet*]],@MODULE[ModuleEngines*]:HAS[~chemTechEngineType,@PROPELLANT[ElectricCharge],@PROPELLANT[IntakeAtm]]]:BEFORE[zzz_ChemicalPropulsion]
{
	chemTechMultiModeEngineSupported = true
}